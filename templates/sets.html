{% extends 'base.html' %}
{% block body %}
<script type="text/javascript">
function changeset(set) {
    $.ajax({
        url     : '/set/'+set.id+'/state/'+set.value,
        accept  : 'application/json',
        success : function(data) {
                set.value=data
            },
        error: function(data) {
            alert('got an error')
            }
    });
}
</script>
<div data-role="page" id="device_list">
	<div data-role="header" data-theme="b">
		<h1>Power Control</h1>
		<a href="/" data-icon="back" class="ui-btn-left">Home</a>
		<a href="/admin/" rel="external" data-icon="gear" class="ui-btn-right">Admin</a>
	</div><!-- /header -->
	
	<div data-role="content">
		<ul data-role="listview" data-inset="true" data-theme="c" data-dividertheme="f" data-filter="true"> 
			{% for set in sets %}
				<li>
					<a href="/set/{{set.tag}}" data-transition="slide">
                        <span>
			<select name="slider" id="{{set.tag}}" class="set" data-role="slider" align="right" onchange="changeset(this);">
				<option value="on" {% if set.state == "On" %}selected{% endif %}>On</option>
				<option value="off" {% if set.state == "Off" %}selected{% endif %}>Off</option>
			</select></span>
						{{set.name}}
                    </a>
				</li>
			{% endfor %}
		</ul>
	</div><!-- /content -->
	
	<div data-role="footer" data-theme="b">
		<h4>Power Control</h4>
	</div><!-- /footer -->
</div><!-- /page -->
{% endblock body %}
